# CSRF

* CSRF（Cross-site request forgery）：**跨站请求伪造**。
* 攻击原理：用户登录  **网站A之后** ，在  **没有登出**  的情况下（及A网站保存在本地cookie的验证信息未清除）,登录了网站B，此时网站B诱导用户发送某个请求到网站A（该请求为用户已有的权限）。
* 防御： 
  *  **Token 验证**      
  *  **把 token 隐藏在 http 的 head头中**       
  *  **Referer 验证：**服务器设置只接受网站A的请求

# XSS

* XSS（Cross Site Scripting）：**跨域脚本攻击**
* 攻击原理：**不需要**你做任何的登录认证，它会通过合法的操作（比如在url中输入、在评论框中输入），向你的页面**注入脚本**（可能是js、hmtl、css、url等）。
* **导致后果：**
  * 盗用Cookie
  * 破坏页面的正常结构，插入广告等恶意内容
  * D-doss攻击（分布式拒绝服务攻击）

* **XSS的攻击方式**
  * 反射型：**xss代码块**随**url**发送到服务器之后随响应内容返回
  * 储存型：**xss代码块**通过**表单提交等**储存在了服务器（数据库，内存，文件系统）

* **XSS的防范措施**

  * 编码（html,js,css,url）
  * 过滤
    * 移除用户输入的和事件相关的属性。如onerror可以自动触发攻击，还有onclick等。（总而言之，过滤掉一些不安全的内容）
    * 移除用户输入的Style节点、Script节点、Iframe节点。（尤其是Script节点，它可是支持跨域的呀，一定要移除）。
  * 校正
    * 避免直接对`HTML Entity`进行解码。
    * 使用`DOM Parse`转换，校正不配对的DOM标签。

  * **第一步的编码转成文本，然后第三步转成DOM对象，然后经过第二步的过滤**
  * **或者：先是encode，如果是富文本，就白名单。**

